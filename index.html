<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Universal Script Converter</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Fira+Code:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-dark: #020617;
            --card-bg: rgba(15, 23, 42, 0.6);
            --primary: #0ea5e9;
            --secondary: #6366f1;
            --accent: #f43f5e;
            --text: #f8fafc;
            --text-muted: #94a3b8;
            --border: rgba(255, 255, 255, 0.08);
            --glow: rgba(14, 165, 233, 0.15);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            scrollbar-width: thin;
            scrollbar-color: var(--border) transparent;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: radial-gradient(circle at 0% 0%, #0f172a 0%, #020617 100%);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Animated Background Blobs */
        .blob {
            position: absolute;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, var(--glow) 0%, transparent 70%);
            z-index: -1;
            filter: blur(80px);
            animation: move 20s infinite alternate;
        }

        @keyframes move {
            from {
                transform: translate(-10%, -10%);
            }

            to {
                transform: translate(20%, 20%);
            }
        }

        /* Glassmorphism Header */
        header {
            padding: 1.25rem 3rem;
            background: rgba(2, 6, 23, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #fff 0%, var(--primary) 50%, var(--secondary) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            letter-spacing: -0.02em;
        }

        .controls {
            display: flex;
            gap: 1.25rem;
            align-items: center;
        }

        select {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid var(--border);
            color: white;
            padding: 0.6rem 2.5rem 0.6rem 1.2rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
            outline: none;
            cursor: pointer;
            transition: all 0.3s;
            appearance: none;
            -webkit-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1rem;
        }

        select:hover {
            border-color: var(--primary);
            background-color: rgba(30, 41, 59, 0.8);
        }

        select option {
            background: #0f172a;
            color: white;
            padding: 10px;
        }

        button {
            padding: 0.6rem 1.5rem;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-outline {
            background: transparent;
            color: var(--text);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--text-muted);
        }

        .btn-convert {
            background: var(--primary);
            color: white;
            border: none;
            box-shadow: 0 4px 15px -3px var(--primary);
        }

        .btn-convert:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px -5px var(--primary);
            filter: brightness(1.1);
        }

        .btn-convert:active {
            transform: translateY(0);
        }

        /* Main Editor Layout */
        main {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr;
            padding: 2.5rem 3rem;
            gap: 2.5rem;
            position: relative;
        }

        .editor-container {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            border-radius: 24px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.5);
            transition: all 0.4s;
            position: relative;
        }

        .editor-header {
            padding: 1rem 1.5rem;
            background: rgba(255, 255, 255, 0.03);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-muted);
            letter-spacing: 0.05em;
        }

        .badge {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 8px;
            border-radius: 6px;
            font-size: 0.7rem;
        }

        textarea {
            flex: 1;
            background: transparent;
            border: none;
            color: #cbd5e1;
            padding: 2rem;
            font-family: 'Fira Code', monospace;
            font-size: 0.95rem;
            line-height: 1.7;
            resize: none;
            outline: none;
        }

        textarea::placeholder {
            color: rgba(255, 255, 255, 0.2);
        }

        /* Status & Loading */
        #status-bar {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            padding: 0.75rem 2rem;
            border-radius: 9999px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            font-size: 0.9rem;
            display: none;
            align-items: center;
            gap: 0.75rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 100;
        }

        .pulse {
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
            box-shadow: 0 0 0 0 rgba(14, 165, 233, 0.7);
            animation: pulse-ring 1.5s infinite;
        }

        @keyframes pulse-ring {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(14, 165, 233, 0.7);
            }

            70% {
                transform: scale(1);
                box-shadow: 0 0 0 10px rgba(14, 165, 233, 0);
            }

            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(14, 165, 233, 0);
            }
        }

        /* Utility */
        .action-link {
            cursor: pointer;
            transition: color 0.2s;
        }

        .action-link:hover {
            color: var(--text);
        }

        .error-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(244, 63, 94, 0.15);
            border-top: 1px solid var(--accent);
            color: #fb7185;
            padding: 0.75rem 1.5rem;
            font-size: 0.85rem;
            backdrop-filter: blur(10px);
            display: none;
            z-index: 5;
            font-family: 'Outfit', sans-serif;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
            }

            to {
                transform: translateY(0);
            }
        }

        #error-msg {
            color: var(--accent);
            font-weight: 500;
        }

        textarea.has-error {
            box-shadow: inset 0 0 15px rgba(244, 63, 94, 0.25);
            border-color: var(--accent);
        }

        /* Responsive */
        @media (max-width: 1100px) {
            main {
                grid-template-columns: 1fr;
                padding: 1.5rem;
                gap: 1.5rem;
                overflow-y: auto;
            }

            body {
                overflow-y: auto;
            }

            header {
                padding: 1rem 1.5rem;
            }
        }
    </style>
</head>

<body>
    <div class="blob"></div>
    <header>
        <div class="logo">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
                stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
            </svg>
            AI Universal Script Converter
        </div>
        <div class="controls">
            <select id="language">
                <option value="typescript">Target: TypeScript</option>
                <option value="javascript">Target: JavaScript</option>
            </select>
            <button class="btn-convert" onclick="convert()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" />
                </svg>
                Convert Now
            </button>
            <button class="btn-outline" onclick="downloadOutput()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3" />
                </svg>
                Download
            </button>
        </div>
    </header>

    <main>
        <div class="editor-container" id="input-container">
            <div class="editor-header">
                <div>SOURCE CODE <span class="badge">AUTO-DETECT</span></div>
                <div class="action-link" onclick="clearInput()">Clear</div>
            </div>
            <textarea id="input" spellcheck="false" placeholder="Paste source code here..."></textarea>
            <div id="error-overlay" class="error-overlay">
                <span style="color:var(--accent);font-weight:600">Error</span> <span id="error-msg"></span>
            </div>
        </div>

        <div class="editor-container">
            <div class="editor-header">
                <div>PLAYWRIGHT <span class="badge" id="lang-badge">TYPESCRIPT</span></div>
                <div class="action-link" onclick="copyOutput()">Copy Code</div>
            </div>
            <textarea id="output" readonly spellcheck="false" placeholder="// Result will appear here..."></textarea>
        </div>
    </main>

    <div id="status-bar">
        <div class="pulse"></div>
        <span id="status-text">Ready</span>
    </div>

    <script>
        const inputEl = document.getElementById('input');
        const outputEl = document.getElementById('output');
        const statusBar = document.getElementById('status-bar');
        const statusText = document.getElementById('status-text');
        const langEl = document.getElementById('language');
        const langBadge = document.getElementById('lang-badge');
        const errorOverlay = document.getElementById('error-overlay');
        const errorMsg = document.getElementById('error-msg');

        langEl.addEventListener('change', () => {
            langBadge.innerText = langEl.value.toUpperCase().replace('TARGET: ', '');
        });

        async function convert() {
            const code = inputEl.value;
            if (!code.trim()) return;

            hideError();
            showStatus('Analyzing & Converting...', true);
            outputEl.value = '// AI is processing your request...';

            try {
                const response = await fetch('http://localhost:11434/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: 'llama3.2:latest',
                        messages: [
                            {
                                role: 'system',
                                content: `You are a Universal Automation Converter.
                                
                                1. Identify source language and convert to Playwright ${langEl.value}.
                                2. Return ONLY the code, no markdown.`
                            },
                            { role: 'user', content: code }
                        ],
                        stream: false
                    })
                });

                if (!response.ok) throw new Error('Ollama connection failed.');

                const data = await response.json();
                let result = data.message.content.trim();

                result = result.replace(/```[a-z]*\n/g, '').replace(/```/g, '').trim();
                outputEl.value = result;
                showStatus('✅ Conversion Successful!', false);
            } catch (error) {
                outputEl.value = `// Error: Connection lost.`;
                showStatus('❌ System Error', false);
            }
        }

        function displayError(msg, line) {
            const lineInfo = line ? ` [Line ${line}]` : '';
            errorMsg.innerText = `${lineInfo}: ${msg}`;
            errorOverlay.style.display = 'block';
            inputEl.classList.add('has-error');
        }

        function hideError() {
            errorOverlay.style.display = 'none';
            inputEl.classList.remove('has-error');
        }

        function showStatus(msg, active) {
            statusText.innerText = msg;
            statusBar.style.display = 'flex';
            if (!active) setTimeout(() => statusBar.style.display = 'none', 4000);
        }

        function copyOutput() {
            if (!outputEl.value) return;
            navigator.clipboard.writeText(outputEl.value);
            showStatus('Copied to clipboard!', false);
        }

        function clearInput() {
            inputEl.value = '';
            outputEl.value = '';
            hideError();
        }

        function downloadOutput() {
            if (!outputEl.value) return;
            const ext = langEl.value.includes('typescript') ? 'ts' : 'js';
            const blob = new Blob([outputEl.value], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `playwright_script.${ext}`;
            a.click();
        }
    </script>
</body>

</html>